1ая версия диплома (защищено на 5). Вторая версия (в разработке) - [edsm-v2](https://github.com/Spanri/edsm-v2)

# СЭД МТУСИ :sweat_drops:

Система электронного документооборота, в которой админ регает пользователей, а пользователи создают документы, подписывают их и просят других пользователей подписать их документы.
Подпись по цепочке на базе блокчейна (алгоритм подписи делал не автор, а другой разработчик, подсказка - он есть в авторах этого проекта).

Vue.js / Django (rest framework)

## Ссылки

[Документация на сервер](https://edms-mtuci.herokuapp.com/api/docsServer/)

[Веб-приложение](https://edms-mtuci.herokuapp.com/app)
Логин: kozlova9v@mail.ru
Пароль: password123

[Панель администратора](https://edms-mtuci.herokuapp.com/api/admin/) (данные администратора спросить у разработчика, но он может и не дать их)

## Интерфейс

Интерфейс в виде скринов показан в самом низу, чтобы не мешаться тут.

## Развернуть проект

== Предисловие ==
Есть много способов запустить проект (любой). Очень удобно "запаковать" запуск в какую-то команду, чтобы программист просто написал команду и всё-всё запустилось.
А еще в программировании нужно устанавливать библиотеки - код, который написан другими разработчиками (чтобы самому не писать кучу давно изобретенных вещей). И этот код имеет версии. Если требуется первая версия, а на компьюетере уже установлена вторая версия - придется сносить вторую версию и устанавливать первую :(
Но можно использовать "изолированную среду" - очень маленькую операционную систему, внутри которой будет запускаться наш код. Мы получим доступ к этой системе через порты, то есть специальные "туннели", по которым мы можем заглядывать внутрь этой операционной системы, смотреть, как там выполняется наш код.
Один из современных вариантов "изолированной среды" - Docker.
== Конец предисловия ==

Для работы используется `Docker` - "программа", в которой я прописываю все настройки фронтенда, бекенда и т.д., а разработчику остается лишь запустить "программу" `Docker` и всё запустится у него на компьютере.

Проблема: я пробовала это лишь на ОС `ubuntu 20`, не знаю, что в `windows` и `macOS`.

Как работать с докером:

1. Установить `Docker`.
Можно в инете погуглить, как это сделать. Я на `ubuntu 20` скачала через программу `synaptic`: выбрала `docker`, `docker-compose` и все пакеты, которые предложило дополнительно установить.

2. Запустить `Docker`
Можно по-разному, но я делаю это так:

```bash
edsm-v1$ cd docker
docker$ docker-compose down
docker$ docker-compose up
```

Здесь `docker-compose down` - удалить все предыдущие запущенные контейнеры.
`docker-compose up` - запустить текущие контейнеры.
Выйти из консоли - `Crtl+C` (2 раза). При этом контейнеры всё ещё будут запущены в фоне. Они, возможно, тратят ресурсы вашего компьютера, поэтому их можно "удалить", если они больше не нужны - `docker-compose down`.

3. Посмотреть нужный контейнер в браузере
`http://localhost:8080` - Фронтенд, для разработки
`http://localhost:8081` - Фронтенд, просто посмотреть
`http://localhost:8082` - Бэкенд (его не посмотреть в браузере, погуглите, с помощью каких программ можно тестировать браузерное API, их оч много)
`http://localhost:5432` - База данных (смотреть через программу, например `dbeaver`)

## Build

(Собрать финальную версию проекта для размещения в интернете)

### Фронтенд

Всё собирается само с помощью Docker-контейнера `edsm_v1_frontend_build`. Итоговая сборка лежит по адресу `/frontend/dist`

### Бекенд

Не забудьте установить python!

``` bash
# установить зависимости
pip3 install -r requirements.txt

# собрать статические файлы, для того, чтобы
# запустить клиент на сервере
python manage.py collectstatic

# миграция таблиц для правильной работы с бд
python manage.py migrate

# Нужно настроить глобальные переменные (для почты, для бд, для
# хранилища амазона и так далее). Все значения секретные, поэтому
# нужно писать разработчику, если он даст - сможете протестировать.
# Ниже пример настройки глобальной переменной. Это для виндовс,
# для юниксов вместо set - export
set EDMS-MAIL-PASSWORD=password

# запустить
python manage.py runserver

# зайти в администратора (данные суперюзера или админа, который есть в
# бд (то есть если известен аккаунт на edms-mtuci.herokuapp.com и
# он админский) или суперюзера). Первая строка - создание суперюзера
# (если нет админского аккаунта)
python manage.py createsuperuser
http://localhost:8000/api/admin/login/?next=/api/admin/

# зайти в приложение, которое фронтенд
http://localhost:8080
```

## Как всё устроено | Статусы связи документа и пользователя

Есть таблица Notif, она связывает документ и пользователя. Отношение связи показывает поле status

| Status | Что значит  
| --- |:---:|
| 0 | Владелец
| 1 | Не владелец, нужна подпись, очередь еще не подошла
| 2 | Не владелец, нужна подпись, очередь подошла
| 3 | Подпись есть, владелец подписанного документа видит уведомление
| 4 | Подпись есть, владелец подписанного документа НЕ видит уведомление
| 5 | Не владелец, подпись не нужна, может только смотреть документ
| 6 | В таблице нет, ставится при возвращении документов для конкретного пользователя тем документам, которые были подписаны этим пользователем (чтобы отличить от документов, которые принадлежат пользователю и находятся в уведомлениях "Ваш документ подписали.")
| 7 | Подписант отказался подписывать

### Интерфейс, вход

Вход (регистрацию делает админ)<br>
<img src="frontend/public/img-git/Вход.png" width="300px" alt="Вход"/>

### Интерфейс, главная

Главная, все документы<br>
<img src="frontend/public/img-git/Главная.png" width="700px" alt="Главная, все документы"/>

Главная, общий доступ (остальные вкладки похожи на "все документы")<br>
<img src="frontend/public/img-git/Главная общий доступ.png" width="700px" alt="Главная, общий доступ"/>

### Интерфейс, документ

Добавление документа<br>
<img src="frontend/public/img-git/Добавить док.png" width="700px" alt="Добавление документа"/>

Документ владельца<br>
<img src="frontend/public/img-git/Документ владелец.png" width="700px" alt="Документ владельца"/>

Документ не владельца (виден ему, ибо он должен его подписать)<br>
<img src="frontend/public/img-git/Документ не владелец.png" width="700px" alt="Документ не владельца"/>

Подписант отказался подписывать и вот это увидел владелец документа<br>
<img src="frontend/public/img-git/Отказ подписывать.png" width="700px" alt="Отказ подписывать"/>

Редактирование документа<br>
<img src="frontend/public/img-git/Редактировать документ.png" width="700px" alt="Редактирование документа"/>

### Интерфейс, письма

Запрос подписи, письмо на почте<br>
<img src="frontend/public/img-git/Запрос подписи.png" width="500px" alt="Запрос подписи"/>

Регистрация, письмо на почте<br>
<img src="frontend/public/img-git/Регистрация письмо.png" width="700px" alt="Регистрация письмо"/>

Сброс пароля, письмо на почте<br>
<img src="frontend/public/img-git/Сброс пароля.png" width="500px" alt="Сброс пароля письмо"/>

### Интерфейс, профиль

Профиль с уведомлениями (фиолетовое - не прочитано)<br>
<img src="frontend/public/img-git/Профиль уведомления.png" width="700px" alt="Профиль уведомления"/>

Редактирование профиля<br>
<img src="frontend/public/img-git/Редактирование профиля.png" width="700px" alt="Редактирование профиля"/>

Администрирование<br>
<img src="frontend/public/img-git/Администрирование.png" width="700px" alt="Администрирование"/>

### Интерфейс, другое

Смена пароля 1<br>
<img src="frontend/public/img-git/Смена пароля.png" width="300px" alt="Смена пароля 1"/>

Смена пароля 2<br>
<img src="frontend/public/img-git/Смена пароля 2.png" width="300px" alt="Смена пароля 2"/>

Помощь (открывается по ссылке в футере)<br>
<img src="frontend/public/img-git/Помощь.png" width="700px" alt="Помощь"/>

<p style="text-align: center;margin:0;margin-top:35px;">Сделала Аня, 2019 - 2022</p>
